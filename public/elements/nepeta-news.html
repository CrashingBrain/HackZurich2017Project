<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../css/shared-style.html">
<link rel="import" href="nepeta-news-card.html">
<script src="../js/ajax.js"></script>

<dom-module id="nepeta-news">
  <template>
    <style include="shared-style">
      :host {
        display: block;
        box-sizing: border-box;
        position: relative;
        left: 8%;
        width: 970px;
        margin: 0 auto !important;
        padding: 0 0 10px 0;
        text-align: center;
      }

      @media (max-width: 1270px) {
        :host {
          width: 700px;
        }
      }

      @media (max-width: 900px) {
        :host {
          left: 0px;
        }
      }

      @media (max-width: 700px) {
        :host {
          width: 400px;
        }
      }

      nepeta-news-card:hover {
        transform: scale(1.2);
        z-index: 5;
        transition: 0.5s;
      }
    </style>

    <template is="dom-repeat" items="{{newsArray}}">
      <nepeta-news-card news=[[item]]></nepeta-news-card>
    </template>

  </template>

  <script>
    Polymer({
      is: 'nepeta-news',

      properties: {
        newsArray: {
          type: Array,
          value: function() { return []; },
          notify: true
        }
      },

      created: function() {
        ajaxRequest('GET', '/room', {}, {}, function(res) {
          this.newsArray = res.data;
          this.newsArray.forEach(function(news) {
            var hashtagString = '';
            news.tags.forEach(function(hashtag) {
              hashtagString += '#' + hashtag + ', ';
            });
            hashtagString = hashtagString.substring(0, hashtagString.length - 2);
            news.tags = hashtagString;
          });
        }.bind(this));
      },
    });
  </script>
</dom-module>
